---
title: "A worked example"
author: "Andrew L Jackson"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{A worked example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteDepends{lamW}
  %\VignetteDepends{tidyverse}
  %\VignetteDepends{patchwork}
  \usepackage[utf8]{inputenc}
---


## Setup

```{r}
library(predictFishRMR)

# for plotting and tibble manipulation
library(tidyverse)


```

## Introduction

Here we use the functions in the pacakge `predictFishRMR` to predict various features of a fishe's metabolism and ecological constraints based on their mass and physiology type. 

For this example we pick a fish with mass = 3000g.

```{r}

# mass of fish
mm <- 3000

# range of water temperatures in C
Ta <- 10

# mesotherm (meso = T) or ecotherm (meso = F)?
mesotherm <- TRUE

# Estimate the cooling coefficient K
K <- kfun(m = mm)

# load the fitted regression model and extract the parameters
data("fittedModelRMR")
pars <- brms::fixef(fittedModelRMR)[,1]

# Estimate the body temperature at thermal equilibrium
Tm <- bodyTempLambert(Ta, m = mm, k = K, meso = mesotherm, pars = pars)

# Estimate routine metabolic rate RMR over the range of  body temperatures
RMR <- RMRfun(mm, Tm, mesotherm, pars = pars)


# create a tibble for plotting in ggplot
dd <- tibble(Ta = Ta, Tm = Tm, RMR = RMR)

```




